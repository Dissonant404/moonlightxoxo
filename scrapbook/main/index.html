<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- <title>Our Love Scrapbook ‚Äî Sagnik & Taneesha</title> -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Great+Vibes&family=Cinzel:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#fff0f6;
      --card:#ffeef8;
      --accent:#ff6fb5;
      --accent-2:#ff9fc1;
      --muted:#8b5e6b;
      --shadow: 0 6px 18px rgba(255,111,181,0.15);
    }
    *{box-sizing:border-box}
    body{
      margin:0;font-family:Poppins,system-ui,Segoe UI,Arial; background:linear-gradient(180deg,var(--bg),#fff5fb); color:#4b2b39;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; padding:50px;
    }
    header{display:flex;gap:18px;align-items:center; justify-content:space-between; margin-bottom:20px}
    .logo{display:flex;align-items:center;gap:14px}
    .logo .heart{font-family:Great Vibes, serif;font-size:36px;color:var(--accent)}
    h1{margin:0;font-size:22px}
    header p{margin:0;color:var(--muted)}

   /* .container{display:grid;grid-template-columns:1fr 360px;gap:20px}
    .main{padding:18px;border-radius:18px;background:linear-gradient(180deg,var(--card),#fff); box-shadow:var(--shadow)}*/
    /*.side{padding:18px;border-radius:18px;background:linear-gradient(180deg,#fff,#fffaf6); box-shadow:var(--shadow); height:fit-content}*/

    /* Polaroid gallery */
    .polaroid-grid{display:flex;flex-wrap:wrap;gap:16px}
    .polaroid{width:170px;background:#fff;border-radius:6px;padding:10px 10px 18px;box-shadow:0 8px 20px rgba(0,0,0,0.08);position:relative;transform:rotate(-2deg)}
    .polaroid img{width:250%;height:200px;object-fit:cover;border-radius:4px}
    .polaroid .caption{margin-top:8px;text-align:center;font-size:12px;color:var(--muted)}
    .polaroid[data-tilt="1"]{transform:rotate(3deg)}

    .uploader{display:flex;gap:8px;align-items:center}
    .uploader input[type=file]{display:none}
    .btn{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;border:none;padding:8px 12px;border-radius:12px;cursor:pointer;font-weight:600}
    .btn.ghost{background:transparent;color:var(--accent);border:1px dashed rgba(255,111,181,0.4)}

    /* Coming soon */
    .coming-soon{border:2px dashed rgba(139,94,107,0.12);padding:28px;border-radius:14px;text-align:center;color:var(--muted)}

    /* Songs */
    .song-list{display:flex;flex-direction:column;gap:10px}
    .song{display:flex;gap:10px;align-items:center;padding:10px;background:#fff;border-radius:10px;box-shadow:0 6px 12px rgba(0,0,0,0.04)}
    .song input[type=text]{flex:1;padding:8px;border-radius:8px;border:1px solid #f1d8e6}

    /* Journal */
    .journal{display:flex;flex-direction:column;gap:8px}
    .journal textarea{min-height:120px;padding:12px;border-radius:10px;border:1px solid #f4d8e5}
    .folder-select{display:flex;gap:8px}

    /* Countdown */
    .countdown{display:flex;gap:12px;align-items:center}
    .countdown .box{background:#fff;padding:10px 12px;border-radius:8px;text-align:center;min-width:60px}
    .small{font-size:12px;color:var(--muted)}
    
    /* Poem Scroll Styles - FIXED VERSION */
    .poems-container {
      display: flex;
      gap: 20px;
      width: 100%;
      justify-content: space-between;
      flex-wrap: wrap;
      margin: 20px 0;
    }
    
    .scroll-container {
      width: 100%;
      max-width: 48%;
      position: relative;
      margin-bottom: 20px;
    }
    
    .scroll {
      background: linear-gradient(to bottom, #fff9f0 0%, #fff0e0 100%);
      border-radius: 10px;
      padding: 30px 25px;
      position: relative;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      color: #1a1a6b;
      font-size: 1rem;
      line-height: 1.5;
      text-align: center;
      overflow: hidden;
      height: 420px; /* Increased height to fit longer poem */
      display: flex;
      flex-direction: column;
      justify-content: flex-start; /* Changed from center to top alignment */
    }
    
    .scroll::before, .scroll::after {
      content: '';
      position: absolute;
      width: 100%;
      height: 30px;
      left: 0;
      background: linear-gradient(to bottom, rgba(173, 20, 87, 0.1) 0%, transparent 100%);
      z-index: 1;
    }
    
    .scroll::before {
      top: 0;
      border-radius: 10px 10px 0 0;
    }
    
    .scroll::after {
      bottom: 0;
      border-radius: 0 0 10px 10px;
      transform: rotate(180deg);
    }
    
    .scroll-content {
      font-family: 'Great Vibes', cursive;
      font-size: 1.3rem;
      line-height: 1.7rem;
      white-space: pre-line;
      position: relative;
      z-index: 2;
      overflow-y: auto; /* Added scroll for overflow */
      max-height: 340px; /* Limit height with scroll */
      padding: 5px;
      text-align: center;
      width: 100%;
    }
    
    /* Custom scrollbar for poem content */
    .scroll-content::-webkit-scrollbar {
      width: 6px;
    }
    
    .scroll-content::-webkit-scrollbar-track {
      background: rgba(173, 20, 87, 0.1);
      border-radius: 3px;
    }
    
    .scroll-content::-webkit-scrollbar-thumb {
      background: rgba(173, 20, 87, 0.3);
      border-radius: 3px;
    }
    
    .scroll-content::-webkit-scrollbar-thumb:hover {
      background: rgba(173, 20, 87, 0.5);
    }
    
    .scroll-top, .scroll-bottom {
      position: absolute;
      width: 100%;
      height: 20px;
      background: #ad1457;
      border-radius: 5px;
      z-index: 0;
    }
    
    .scroll-top {
      top: -10px;
      box-shadow: 0 -3px 10px rgba(0, 0, 0, 0.15);
    }
    
    .scroll-bottom {
      bottom: -10px;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15);
    }
    
    .scroll-top::before, .scroll-bottom::before {
      content: '';
      position: absolute;
      width: 30px;
      height: 30px;
      background: #8a1145;
      border-radius: 50%;
      top: 50%;
      transform: translateY(-50%);
    }
    
    .scroll-top::before {
      left: -15px;
    }
    
    .scroll-bottom::before {
      right: -15px;
    }
    
    .scroll-top::after, .scroll-bottom::after {
      content: '';
      position: absolute;
      width: 30px;
      height: 30px;
      background: #8a1145;
      border-radius: 50%;
      top: 50%;
      transform: translateY(-50%);
    }
    
    .scroll-top::after {
      right: -15px;
    }
    
    .scroll-bottom::after {
      left: -15px;
    }
    
    .poem-title {
      text-align: center;
      margin-bottom: 15px;
      font-family: 'Cinzel', serif;
      font-size: 1.3rem;
      color: #4b2b39;
    }
    
    .poem-signature {
      text-align: right;
      margin-top: 15px;
      font-family: 'Great Vibes', cursive;
      font-size: 1.3rem;
      color: #ad1457;
      position: absolute;
      bottom: 20px;
      right: 25px;
      width: calc(100% - 50px);
    }

    footer{margin-top:18px;color:var(--muted);font-size:13px;text-align:center}

    /* responsive */
    /*@media (max-width:960px){.container{grid-template-columns:1fr}.side{order:2}}*/
    
    @media (max-width: 768px) {
      .poems-container {
        flex-direction: column;
        align-items: center;
      }
      
      .scroll-container {
        max-width: 100%;
      }
      
      .scroll-content {
        font-size: 1.2rem;
        line-height: 1.6rem;
        max-height: 300px;
      }
      
      .scroll {
        padding: 25px 20px;
        height: 380px;
      }
      
      .poem-signature {
        bottom: 15px;
        right: 20px;
        width: calc(100% - 40px);
      }
    }

  </style>
</head>
<body>


<script>
document.addEventListener('DOMContentLoaded', function() {
  const video = document.getElementById('bgVideo');
  if(video) {
    video.play().catch(e => {
      console.log('Video play failed:', e);
    });
  }
});
</script>
<header>
  <div class="logo">
    <!-- <div class="heart">üíñ</div> -->
    <div>
      <h1>Our Love Scrapbook</h1>
      <p>For Taneesha üíñ</p> 
    </div>
  </div>
</header>

<style>
  /* Updated Header Styles */
  header {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    margin-bottom: 30px;
    text-align: center;
  }

  .logo {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
  }

  .logo .heart {
    font-family: 'Great Vibes', cursive;
    font-size: 48px;
    color: #ff6fb5;
  }

  .logo h1 {
    font-family: 'Great Vibes', cursive;
    font-size: 3.5rem;
    color: #8a1145;
    margin: 0;
    line-height: 1.2;
  }

  .logo p {
    font-family: 'Great Vibes', cursive;
    font-size: 1.8rem;
    color: #8b5e6b;
    margin: 0;
    line-height: 1.2;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .logo h1 {
      font-size: 2.8rem;
    }
    
    .logo p {
      font-size: 1.5rem;
    }
  }

  @media (max-width: 480px) {
    .logo h1 {
      font-size: 2.2rem;
    }
    
    .logo p {
      font-size: 1.2rem;
    }
    
    .logo .heart {
      font-size: 36px;
    }
  }
</style>
 <br> <br> <br>
  <div class="container">
    <main class="main">

      <!-- Countdown -->
      <section style="margin-bottom:18px">
        <h2 style="font-size:25px;margin-bottom:8px">Countdown until we meet</h2>
        <div class="countdown" id="countdown">
          <div class="box"><div id="d">0</div><div class="small">Days</div></div>
          <div class="box"><div id="h">0</div><div class="small">Hours</div></div>
          <div class="box"><div id="m">0</div><div class="small">Minutes</div></div>
          <div class="box"><div id="s">0</div><div class="small">Seconds</div></div>
        </div>
        <!-- <div class="small" style="margin-top:8px">Target date: <strong>December 22, 2025 ‚Äî 23:59</strong> (changeable in script)</div> -->
      </section>


      <!-- Add this CSS -->
<style>


        .album-container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Book Styles */
        .book-container {
            position: relative;
            width: 100%;
            height: 600px;
            margin: 0 auto;
            perspective: 2000px;
        }

        .book {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.5s ease;
        }

        /* Book Cover */
        .book-cover {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #8a1145, #6a0f39);
            border-radius: 10px 20px 20px 10px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 10;
            transform-origin: left center;
            transform: rotateY(0deg);
            transition: transform 1s ease;
            cursor: pointer;
            border: 1px solid #5a0a29;
        }

        .book-cover::before {
            content: '';
            position: absolute;
            top: 20px;
            bottom: 20px;
            left: 20px;
            right: 20px;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 5px;
        }

        .book-cover h2 {
            font-family: 'Cinzel', serif;
            font-size: 2.8rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .book-cover p {
            font-size: 1.2rem;
            text-align: center;
            max-width: 80%;
            margin-bottom: 10px;
        }

        .book-cover .subtitle {
            font-family: 'Great Vibes', cursive;
            font-size: 1.8rem;
            margin-top: 20px;
        }

        .book-cover.open {
            transform: rotateY(-160deg);
        }

        /* Pages */
        .page {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: #fff9f0;
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
            padding: 30px;
            overflow: hidden;
            transform-style: preserve-3d;
            backface-visibility: hidden;
            display: none;
            border: 1px solid #e8d5c4;
        }

        .page.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .page-content {
            width: 100%;
            height: 100%;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            padding: 20px;
            overflow-y: auto;
            align-content: start;
            position: relative;
        }

        /* Polaroids with "pasted" effect */
        .album-polaroid {
            background: white;
            padding: 15px 15px 25px;
            border-radius: 5px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            position: relative;
            transition: all 0.3s ease;
            height: fit-content;
            width: 100%;
            max-width: 250px;
            margin: 0 auto;
            transform: rotate(var(--rotation));
            border: 1px solid #f1d8e6;
        }

        .album-polaroid::before {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            background: rgba(0,0,0,0.05);
            border-radius: 8px;
            z-index: -1;
        }

        .album-polaroid:hover {
            transform: rotate(0deg) scale(1.05);
            z-index: 10;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
        }

        .album-polaroid img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 3px;
            border: 1px solid #f1d8e6;
        }

        .album-polaroid .caption {
            margin-top: 12px;
            text-align: center;
            font-size: 14px;
            color: #8b5e6b;
            font-weight: 500;
            padding: 0 5px;
        }

        .album-polaroid .heart {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            backdrop-filter: blur(5px);
            opacity: 0;
            transition: opacity 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .album-polaroid:hover .heart {
            opacity: 1;
        }

        /* Book Controls */
        .album-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 30px;
        }

        .page-indicator {
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .page-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #f1d8e6;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .page-dot.active {
            background: #ff6fb5;
            transform: scale(1.2);
        }

        .nav-btn {
            background: #ff6fb5;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(255, 111, 181, 0.3);
        }

        .nav-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(255, 111, 181, 0.4);
            background: #ff9fc1;
        }

        .nav-btn:disabled {
            background: #f1d8e6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .album-stats {
            text-align: center;
            color: #8b5e6b;
            font-size: 14px;
            margin-top: 10px;
        }

        .upload-feedback {
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            color: #ff6fb5;
            min-height: 20px;
            transition: opacity 0.3s ease;
        }

        .album-upload {
            text-align: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px dashed #f1d8e6;
        }

        .btn {
            background: linear-gradient(90deg, #ff6fb5, #ff9fc1);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            margin: 5px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 111, 181, 0.4);
        }

        .btn.ghost {
            background: transparent;
            color: #ff6fb5;
            border: 1px dashed rgba(255, 111, 181, 0.4);
        }

        /* Random rotations for polaroids */
        .album-polaroid:nth-child(odd) { --rotation: -3deg; }
        .album-polaroid:nth-child(even) { --rotation: 2deg; }
        .album-polaroid:nth-child(3n) { --rotation: -1deg; }
        .album-polaroid:nth-child(4n) { --rotation: 4deg; }
        .album-polaroid:nth-child(5n) { --rotation: -2deg; }
        .album-polaroid:nth-child(6n) { --rotation: 1deg; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .book-container {
                height: 500px;
            }
            
            .page-content {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 15px;
                padding: 10px;
            }
            
            .album-polaroid {
                max-width: 200px;
            }
            
            .album-polaroid img {
                height: 150px;
            }
            
            .nav-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            .book-container {
                height: 400px;
            }
            
            .page-content {
                grid-template-columns: 1fr;
            }
            
            .album-polaroid {
                max-width: 100%;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
  <!--   <div class="header">
        <h1>Our Love Scrapbook</h1>
        <p>For Sagnik & Taneesha ‚Äî A collection of our precious memories</p>
    </div> -->
<br><br><br>
   <script>
class PhotoAlbum {
    constructor() {
        this.currentPage = 1;
        this.totalPages = 10;
        this.photosPerPage = 4;
        this.photos = [];
        this.bookOpen = false;

        this.CLOUD_NAME = 'YOUR_CLOUD_NAME'; // Replace with your Cloudinary cloud name
        this.UPLOAD_PRESET = 'YOUR_UPLOAD_PRESET'; // Replace with an unsigned preset

        this.init();
    }

    init() {
        this.createPages();
        this.loadPhotos();
        this.createPageIndicators();
        this.updateNavigation();
        this.setupEventListeners();
        this.renderPhotos();
    }

    createPages() {
        const book = document.querySelector('.book');

        // Clear existing pages except cover
        const existingPages = document.querySelectorAll('.page');
        existingPages.forEach(page => {
            if (!page.classList.contains('book-cover')) page.remove();
        });

        for (let i = 1; i <= this.totalPages; i++) {
            const page = document.createElement('div');
            page.className = `page ${i === 1 ? 'active' : ''}`;
            page.id = `page-${i}`;

            const pageContent = document.createElement('div');
            pageContent.className = 'page-content';
            page.appendChild(pageContent);

            book.appendChild(page);
        }
    }

    loadPhotos() {
        const saved = localStorage.getItem('love-scrapbook-album');
        if (saved) this.photos = JSON.parse(saved);
    }

    savePhotos() {
        localStorage.setItem('love-scrapbook-album', JSON.stringify(this.photos));
    }

    getNextAvailablePage() {
        const pageCounts = {};
        for (let i = 1; i <= this.totalPages; i++) pageCounts[i] = 0;

        this.photos.forEach(photo => {
            if (pageCounts[photo.page] !== undefined) pageCounts[photo.page]++;
        });

        for (let i = 1; i <= this.totalPages; i++) {
            if (pageCounts[i] < this.photosPerPage) return i;
        }
        return 1;
    }

    createPageIndicators() {
        const indicator = document.getElementById('page-indicator');
        indicator.innerHTML = '';

        for (let i = 1; i <= this.totalPages; i++) {
            const dot = document.createElement('div');
            dot.className = `page-dot ${i === this.currentPage ? 'active' : ''}`;
            dot.dataset.page = i;
            dot.addEventListener('click', () => this.goToPage(i));
            indicator.appendChild(dot);
        }

        document.getElementById('total-pages').textContent = this.totalPages;
        this.updateStats();
    }

    goToPage(page) {
        if (page < 1 || page > this.totalPages) return;
        document.querySelector('.page.active').classList.remove('active');
        this.currentPage = page;
        document.getElementById(`page-${this.currentPage}`).classList.add('active');

        this.updateNavigation();
        this.updatePageIndicators();
        this.updateStats();
    }

    nextPage() {
        if (this.currentPage < this.totalPages) this.goToPage(this.currentPage + 1);
    }

    prevPage() {
        if (this.currentPage > 1) this.goToPage(this.currentPage - 1);
    }

    updateNavigation() {
        document.getElementById('prev-page').disabled = this.currentPage === 1;
        document.getElementById('next-page').disabled = this.currentPage === this.totalPages;
    }

    updatePageIndicators() {
        document.querySelectorAll('.page-dot').forEach((dot, index) => {
            dot.classList.toggle('active', index + 1 === this.currentPage);
        });
    }

    updateStats() {
        document.getElementById('current-page').textContent = this.currentPage;
        document.getElementById('total-photos').textContent = this.photos.length;
        const currentPagePhotos = this.photos.filter(photo => photo.page === this.currentPage).length;
        document.getElementById('photos-on-page').textContent = currentPagePhotos;
    }

    setupEventListeners() {
        document.getElementById('book-cover').addEventListener('click', () => this.openBook());
        document.getElementById('prev-page').addEventListener('click', () => this.prevPage());
        document.getElementById('next-page').addEventListener('click', () => this.nextPage());

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') this.prevPage();
            if (e.key === 'ArrowRight') this.nextPage();
        });

        // Cloudinary file upload
        document.getElementById('album-file').addEventListener('change', (e) => {
            this.handleCloudUpload(e.target.files);
            e.target.value = '';
        });

        document.getElementById('clear-album').addEventListener('click', () => {
            if (confirm('Clear all photos from the album?')) {
                this.photos = [];
                this.savePhotos();
                this.renderPhotos();
                this.updateStats();
                this.showFeedback('All photos cleared from album');
            }
        });
    }

    openBook() {
        if (!this.bookOpen) {
            document.getElementById('book-cover').classList.add('open');
            this.bookOpen = true;
        }
    }

    async handleCloudUpload(files) {
        if (files.length === 0) return;

        let uploadedCount = 0;
        const totalFiles = files.length;

        for (const file of files) {
            if (!file.type.startsWith('image/')) {
                this.showFeedback('Please select image files only');
                continue;
            }

            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', this.UPLOAD_PRESET);

            try {
                const res = await fetch(`https://api.cloudinary.com/v1_1/${this.CLOUD_NAME}/upload`, {
                    method: 'POST',
                    body: formData
                });

                const data = await res.json();
                if (data.secure_url) {
                    const nextPage = this.getNextAvailablePage();
                    const photo = {
                        data: data.secure_url,
                        caption: this.generateCaption(file.name),
                        date: Date.now(),
                        page: nextPage
                    };
                    this.photos.unshift(photo);
                    uploadedCount++;

                    // Auto-navigate to the page where photos were added
                    this.goToPage(nextPage);
                    this.openBook();
                }

            } catch (err) {
                console.error(err);
                this.showFeedback('Upload failed. Try again.');
            }
        }

        if (uploadedCount > 0) {
            this.savePhotos();
            this.renderPhotos();
            this.updateStats();
            this.showFeedback(`Added ${uploadedCount} photo${uploadedCount > 1 ? 's' : ''} to album!`);
        }
    }

    generateCaption(filename) {
        const nameWithoutExt = filename.replace(/\.[^/.]+$/, "");
        const captions = [
            "Beautiful memory üí´", "Precious moment üåü", "Our special day ‚ú®",
            "Love this memory üíñ", "Perfect moment üåà", "Cherished memory üå∏",
            "Our happiness üòä", "Sweet memories üç¨", "Together forever üíï",
            "My favorite smile üòÑ"
        ];
        if (nameWithoutExt.length > 3 && !nameWithoutExt.match(/^[0-9a-f]+$/i)) return nameWithoutExt;
        return captions[Math.floor(Math.random() * captions.length)];
    }

    renderPhotos() {
        for (let i = 1; i <= this.totalPages; i++) {
            const pageContent = document.getElementById(`page-${i}`).querySelector('.page-content');
            pageContent.innerHTML = '';
        }

        this.photos.forEach(photo => {
            const pageContent = document.getElementById(`page-${photo.page}`).querySelector('.page-content');
            const polaroid = this.createPolaroid(photo);
            pageContent.appendChild(polaroid);
        });

        if (this.photos.length === 0) {
            const firstPage = document.getElementById('page-1').querySelector('.page-content');
            firstPage.innerHTML = `
                <div style="text-align: center; width: 100%; padding: 50px; color: #8b5e6b; grid-column: 1 / -1;">
                    <div style="font-size: 48px; margin-bottom: 20px;">üì∑</div>
                    <h3>No photos yet</h3>
                    <p>Click "Add Photos to Album" to start building your memory book!</p>
                    <p style="font-size: 12px; margin-top: 10px;">Photos will be added in 4R size format (4x6 inches)</p>
                </div>`;
        }
    }

    createPolaroid(photo) {
        const polaroid = document.createElement('div');
        polaroid.className = 'album-polaroid';

        const heart = document.createElement('div');
        heart.className = 'heart';
        heart.innerHTML = 'üíñ';

        const img = document.createElement('img');
        img.src = photo.data;
        img.alt = photo.caption;
        img.onerror = function() {
            this.src = 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="300" height="400" viewBox="0 0 300 400"><rect width="300" height="400" fill="%23f1d8e6"/><text x="150" y="200" font-family="Arial" font-size="16" fill="%234b2b39" text-anchor="middle" dy=".3em">4R Photo</text></svg>';
        };

        const caption = document.createElement('div');
        caption.className = 'caption';
        caption.textContent = photo.caption;

        polaroid.appendChild(heart);
        polaroid.appendChild(img);
        polaroid.appendChild(caption);

        return polaroid;
    }

    showFeedback(message) {
        const feedback = document.getElementById('upload-feedback');
        feedback.textContent = message;
        feedback.style.opacity = '1';
        setTimeout(() => { feedback.style.opacity = '0'; }, 4000);
    }
}

document.addEventListener('DOMContentLoaded', () => { new PhotoAlbum(); });
</script>

</body>


    <!-- Updated CSS for video calls section with scroller -->
<style>
  /* Video Calls Section with Horizontal Scroller */
  .snapshots-section {
    margin-bottom: 30px !important;
  }

  .polaroid-scroll-container {
    position: relative;
    width: 100%;
    overflow-x: auto;
    overflow-y: hidden;
    padding: 20px 10px 30px;
    margin: 0 -10px;
    scrollbar-width: thin;
    scrollbar-color: var(--accent) transparent;
  }

  .polaroid-scroll-container::-webkit-scrollbar {
    height: 8px;
  }

  .polaroid-scroll-container::-webkit-scrollbar-track {
    background: rgba(255, 111, 181, 0.1);
    border-radius: 4px;
    margin: 0 10px;
  }

  .polaroid-scroll-container::-webkit-scrollbar-thumb {
    background: var(--accent);
    border-radius: 4px;
  }

  .polaroid-scroll-container::-webkit-scrollbar-thumb:hover {
    background: var(--accent-2);
  }

  .polaroid-grid {
    display: flex;
    gap: 20px;
    padding: 10px 5px;
    width: max-content;
    min-width: 100%;
  }

  .polaroid {
    width: 220px;
    background: #fff;
    border-radius: 8px;
    padding: 15px 15px 25px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.12);
    position: relative;
    transform: rotate(-2deg);
    transition: transform 0.3s ease;
    flex-shrink: 0;
  }

  .polaroid:hover {
    transform: rotate(0deg) scale(1.05);
    box-shadow: 0 15px 35px rgba(0,0,0,0.2);
  }

  .polaroid img {
    width: 100%;
    height: 180px;
    object-fit: cover;
    border-radius: 6px;
    border: 1px solid #f1d8e6;
  }

  .polaroid .caption {
    margin-top: 12px;
    text-align: center;
    font-size: 14px;
    color: var(--muted);
    font-weight: 500;
  }

  .polaroid[data-tilt="1"] {
    transform: rotate(3deg);
  }

  .polaroid[data-tilt="1"]:hover {
    transform: rotate(0deg) scale(1.05);
  }

  /* Scroll indicators */
  .scroll-hint {
    text-align: center;
    color: var(--muted);
    font-size: 12px;
    margin-top: 5px;
    opacity: 0.7;
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 1; }
  }

  /* Empty state */
  .empty-gallery {
    text-align: center;
    padding: 40px 20px;
    color: var(--muted);
  }

  .empty-gallery .icon {
    font-size: 48px;
    margin-bottom: 15px;
    opacity: 0.5;
  }

  .empty-gallery p {
    margin: 0;
    font-size: 14px;
  }

  /* Uploader styles */
  .uploader {
    display: flex;
    gap: 12px;
    align-items: center;
    margin-bottom: 20px;
    flex-wrap: wrap;
  }

  .uploader .btn {
    padding: 10px 16px;
    font-size: 14px;
  }

  /* Section header */
  .snapshots-section h2 {
    font-size: 20px !important;
    margin-bottom: 15px !important;
  }
</style>
<br><br><br>
<!-- Updated HTML for video calls section -->
<section class="snapshots-section">
  <h2 style="font-size:20px;margin-bottom:15px">Snapshots from our video calls</h2>
  <div class="uploader">
    <label class="btn" for="vc-file">Add snapshot</label>
    <input id="vc-file" type="file" accept="image/*" />
    <button class="btn ghost" id="clear-vc">Clear gallery</button>
  </div>
  
  <div class="polaroid-scroll-container">
    <div class="polaroid-grid" id="vc-grid" aria-live="polite">
      <!-- Polaroids will be added here dynamically -->
    </div>
  </div>
  
  <div class="scroll-hint" id="scroll-hint" style="display: none;">
    ‚Üê Scroll to see more photos ‚Üí
  </div>
</section>

<!-- Updated JavaScript for video calls section -->
<script>
  /* ---------- Video Calls Section with Horizontal Scroller ---------- */
  const vcFile = document.getElementById('vc-file');
  const vcGrid = document.getElementById('vc-grid');
  const scrollHint = document.getElementById('scroll-hint');
  const VC_KEY = 'vc-snapshots';

  function loadVC() {
    const arr = JSON.parse(localStorage.getItem(VC_KEY) || '[]');
    vcGrid.innerHTML = '';
    
    if (arr.length === 0) {
      vcGrid.innerHTML = `
        <div class="empty-gallery" style="width: 100%; text-align: center;">
          <div class="icon">üì∏</div>
          <p>No snapshots yet</p>
          <p style="font-size: 12px; margin-top: 5px;">Add your first video call snapshot!</p>
        </div>
      `;
      scrollHint.style.display = 'none';
      return;
    }

    arr.forEach((i, idx) => {
      const div = document.createElement('div'); 
      div.className = 'polaroid'; 
      if (idx % 2 === 0) div.setAttribute('data-tilt', '1');
      
      const img = document.createElement('img'); 
      img.src = i.data; 
      img.alt = i.caption || 'video call snapshot';
      
      const cap = document.createElement('div'); 
      cap.className = 'caption'; 
      cap.textContent = i.caption || new Date(i.date).toLocaleDateString();
      
      div.appendChild(img); 
      div.appendChild(cap);
      vcGrid.appendChild(div);
    });

    // Show scroll hint if there are many photos
    scrollHint.style.display = arr.length > 3 ? 'block' : 'none';
  }

  vcFile.addEventListener('change', async e => {
    const f = e.target.files[0]; 
    if (!f) return;
    
    const reader = new FileReader();
    reader.onload = () => {
      const data = reader.result;
      const arr = JSON.parse(localStorage.getItem(VC_KEY) || '[]');
      arr.unshift({
        data, 
        date: Date.now(),
        caption: `Video call - ${new Date().toLocaleDateString()}`
      });
      localStorage.setItem(VC_KEY, JSON.stringify(arr.slice(0, 50))); // Increased limit
      loadVC();
    }
    reader.readAsDataURL(f);
    e.target.value = '';
  });

  document.getElementById('clear-vc').addEventListener('click', () => { 
    if (confirm('Clear all video call snapshots?')) { 
      localStorage.removeItem(VC_KEY); 
      loadVC(); 
    } 
  });

  // Initialize on load
  loadVC();

  // Auto-hide scroll hint after scrolling
  const scrollContainer = document.querySelector('.polaroid-scroll-container');
  scrollContainer.addEventListener('scroll', () => {
    scrollHint.style.opacity = '0.3';
    setTimeout(() => {
      scrollHint.style.opacity = '0.7';
    }, 3000);
  });
</script>

      <!-- Dates -->
      <section style="margin-bottom:20px">
        <h2 style="font-size:18px;margin-bottom:8px">Snapshots of our dates</h2>
        <div class="coming-soon">
          <h3 style="margin:0 0 8px 0">It's coming soon babe üòä</h3>
        <!--   <p>We're preparing a special layout for our date-night memories (map pins, little notes, and ribbons). Uploads are supported ‚Äî they'll appear here once the feature is enabled.</p> -->
        </div>
      </section>

      <!-- Favourite songs -->
     <section style="margin-bottom:20px">
  <h2 style="font-size:18px;margin-bottom:8px">Our favourite songs</h2>
  <div style="margin-bottom:8px;color:var(--muted);font-size:13px">
    Add a Spotify song URL to display a large player
  </div>
  <div class="song-input-container">
    <input id="song-url" type="text" placeholder="Paste Spotify song URL here..." />
    <button class="btn" id="add-song">Add Song</button>
  </div>
  <div class="song-list" id="songs"></div>
</section>

      <!-- Poems Section -->
      <section style="margin-bottom:20px">
        <h2 style="font-size:18px;margin-bottom:8px">my Poems</h2>
        <div class="poems-container">
          <div class="scroll-container">
            <h3 class="poem-title">Moonlit Reverie</h3>
            <div class="scroll-top"></div>
            <div class="scroll">
              <div class="scroll-content">
I look up the sky;
see the moon ever so bright
mimicking your sweet face;
illuminating the night sky
just as you illuminate my dark times

the glowing white moon feels so near
like your virtual, comforting presence right here...
yet so far
like the feeling of warming love of your touch
              </div>
              <!-- <div class="poem-signature">- Sagnik</div> -->
            </div>
            <div class="scroll-bottom"></div>
          </div>
          
          <div class="scroll-container">
            <h3 class="poem-title">Golden Perfection</h3>
            <div class="scroll-top"></div>
            <div class="scroll">
              <div class="scroll-content">
Your face so golden and pure;
it glows in the sunlight's kiss

your gentle, imploring eyes
makes my body weak to my ties

your lustrous lips
makes me wanna yearn for a kiss

your cascading hair looks so smooth and shiny
just like the spirals of the milky way galaxy

your bare shoulders so sharp and sexy for my innocent eyes
I almost choke on my breath

your sweet and calming voice so therapeutic
it lulls my soul to peace

feels surreal, how lucky I am 
to call the most perfect girl in the world, mine
              </div>
              <!-- <div class="poem-signature">- Sagnik</div> -->
            </div>
            <div class="scroll-bottom"></div>
          </div>
        </div>
      </section>

      <!-- Footer notes -->
     
  </div>
<!-- Add this CSS to your existing styles -->
<style>
  /* Love Letters Section */
  .love-letters-container {
    display: flex;
    gap: 20px;
    width: 100%;
    overflow-x: auto;
    padding: 10px 5px 20px;
    margin: 20px 0;
    scrollbar-width: thin;
    scrollbar-color: var(--accent) transparent;
  }

  .love-letters-container::-webkit-scrollbar {
    height: 8px;
  }

  .love-letters-container::-webkit-scrollbar-track {
    background: rgba(255, 111, 181, 0.1);
    border-radius: 4px;
  }

  .love-letters-container::-webkit-scrollbar-thumb {
    background: var(--accent);
    border-radius: 4px;
  }

  .envelope {
    min-width: 280px;
    max-width: 320px;
    background: linear-gradient(135deg, #fff9f0 0%, #fff5eb 100%);
    border-radius: 8px;
    padding: 0;
    position: relative;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    cursor: pointer;
    transition: all 0.3s ease;
    border: 1px solid #f1d8e6;
    overflow: hidden;
  }

  .envelope:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
  }

  .envelope.closed {
    height: 180px;
  }

  .envelope.open {
    height: auto;
    min-height: 400px;
  }

  .envelope-flap {
    width: 100%;
    height: 40px;
    background: linear-gradient(135deg, #ad1457 0%, #8a1145 100%);
    position: relative;
    clip-path: polygon(0 0, 100% 0, 50% 100%);
    transition: all 0.3s ease;
  }

  .envelope.open .envelope-flap {
    clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%);
    height: 20px;
    border-radius: 8px 8px 0 0;
  }

  .envelope-content {
    padding: 25px 20px;
    color: #4b2b39;
    font-family: 'Great Vibes', cursive;
    font-size: 1.2rem;
    line-height: 1.6;
    text-align: left;
    display: none;
  }

  .envelope.open .envelope-content {
    display: block;
    animation: fadeIn 0.5s ease;
  }

  .envelope-preview {
    padding: 30px 20px;
    text-align: center;
    color: var(--muted);
    font-style: italic;
  }

  .envelope.open .envelope-preview {
    display: none;
  }

  .letter-header {
    font-family: 'Cinzel', serif;
    font-size: 1.1rem;
    margin-bottom: 15px;
    color: #ad1457;
    text-align: center;
  }

  .letter-content {
    margin-bottom: 20px;
    white-space: pre-line;
  }

  .letter-footer {
    font-family: 'Cinzel', serif;
    font-size: 1.1rem;
    text-align: right;
    color: #ad1457;
    margin-top: 25px;
  }

  .envelope-seal {
    position: absolute;
    top: 25px;
    right: 20px;
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, #ff6fb5 0%, #ad1457 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.2rem;
    box-shadow: 0 3px 10px rgba(173, 20, 87, 0.3);
  }

  .envelope.open .envelope-seal {
    display: none;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @media (max-width: 768px) {
    .envelope {
      min-width: 250px;
    }
    
    .envelope-content {
      font-size: 1.1rem;
    }
  }
</style>

<!-- Add this HTML to your main content section, after the poems -->
<section style="margin-bottom:20px">
  <h2 style="font-size:18px;margin-bottom:8px">Love Letters</h2>
  <div class="love-letters-container">
    <!-- Letter 1 -->
    <div class="envelope closed" onclick="toggleEnvelope(this)">
      <div class="envelope-flap"></div>
      <div class="envelope-seal">üíå</div>
      <div class="envelope-preview">
        Click to open this love letter...
      </div>
      <div class="envelope-content">
        <div class="letter-header">Dear Taneesha,</div>
        <div class="letter-content">
In this university, whenever I experience any event‚Äîwhether it be walking to class, drowsing in lecture classes, sitting by the seashore, cramming in the library, feasting in the canteen, or bedrotting in the dorm‚ÄîI always imagine you beside me at all times. This gives me a sense of comfort and hope for us. The distance might keep us apart, but your presence resonates in my heart.

When I gaze up at the stars, I'm reminded of our love; each twinkle sparkles with each small but special memory of ours, whether it be in text, video chats, or our situationship days. Each of these sparkling moments is building us a house for our bond, so when we finally meet, our reunion will feel like a dear, sweet home.
        </div>
        <div class="letter-footer">Love, Sagnik</div>
      </div>
    </div>

    <!-- Letter 2 -->
    <div class="envelope closed" onclick="toggleEnvelope(this)">
      <div class="envelope-flap"></div>
      <div class="envelope-seal">üíå</div>
      <div class="envelope-preview">
        Click to open this love letter...
      </div>
      <div class="envelope-content">
        <div class="letter-header">Dear Taneesha,</div>
        <div class="letter-content">
Babe, spending 2+ months virtually with you made me realize how grateful I am to have you by my side. I miss every second I'm not there with you physically, but no matter the distance, your presence is sheltered deep in my heart.

I will never regret any moments between us, whether virtual or physical, because in each of them, I felt secure and calm, like being cozied up on your lap. Our nightly calls, your laughs and smiles, our giggles during conversations will always be a core, jolly part of my memory.

When things get tough, remember I will always want to be with you; I'll support you through your journey and cheer you on as you fulfill every choice of yours. I love you so much, Taneesha. You really do mean the world to me.
        </div>
        <div class="letter-footer">Love, Sagnik</div>
      </div>
    </div>
  </div>
</section>

<!-- Add this JavaScript to your existing script -->
<script>
  function toggleEnvelope(envelope) {
    // Close all other envelopes
    document.querySelectorAll('.envelope.open').forEach(otherEnvelope => {
      if (otherEnvelope !== envelope) {
        otherEnvelope.classList.remove('open');
        otherEnvelope.classList.add('closed');
      }
    });
    
    // Toggle current envelope
    envelope.classList.toggle('open');
    envelope.classList.toggle('closed');
  }

  // Close envelope when clicking outside
  document.addEventListener('click', function(event) {
    if (!event.target.closest('.envelope')) {
      document.querySelectorAll('.envelope.open').forEach(envelope => {
        envelope.classList.remove('open');
        envelope.classList.add('closed');
      });
    }
  });
</script>


  <script>
    /* ---------- Countdown ---------- */
    // Target: 22 Dec 2025 23:59 local time
    const target = new Date('2025-12-22T23:59:00');
    function updateCountdown(){
      const now = new Date();
      let diff = Math.max(0, target - now);
      const days = Math.floor(diff / (1000*60*60*24)); diff -= days*(1000*60*60*24);
      const hours = Math.floor(diff / (1000*60*60)); diff -= hours*(1000*60*60);
      const minutes = Math.floor(diff / (1000*60)); diff -= minutes*(1000*60);
      const seconds = Math.floor(diff/1000);
      document.getElementById('d').textContent = days;
      document.getElementById('h').textContent = hours;
      document.getElementById('m').textContent = minutes;
      document.getElementById('s').textContent = seconds;
    }
    setInterval(updateCountdown, 1000);
    updateCountdown();



    function loadVC(){
      const arr = JSON.parse(localStorage.getItem(VC_KEY) || '[]');
      vcGrid.innerHTML = '';
      arr.forEach((i,idx)=>{
        const div = document.createElement('div'); div.className='polaroid'; if(idx%2===0) div.setAttribute('data-tilt','1');
        const img = document.createElement('img'); img.src = i.data; img.alt = i.caption||'snapshot';
        const cap = document.createElement('div'); cap.className='caption'; cap.textContent = i.caption || new Date(i.date).toLocaleString();
        div.appendChild(img); div.appendChild(cap);
        vcGrid.appendChild(div);
      })
    }
    vcFile.addEventListener('change', async e=>{
      const f = e.target.files[0]; if(!f) return;
      const reader = new FileReader();
      reader.onload = ()=>{
        const data = reader.result;
        const arr = JSON.parse(localStorage.getItem(VC_KEY) || '[]');
        arr.unshift({data, date:Date.now()});
        localStorage.setItem(VC_KEY, JSON.stringify(arr.slice(0,60)));
        loadVC();
      }
      reader.readAsDataURL(f);
      e.target.value = '';
    })
    document.getElementById('clear-vc').addEventListener('click', ()=>{ if(confirm('Clear all snapshots?')){ localStorage.removeItem(VC_KEY); loadVC(); } })
    loadVC();

    /* ---------- Songs ---------- */
    const songsEl = document.getElementById('songs');
    const SONGS_KEY = 'scrapbook-songs';
    function loadSongs(){
      const arr = JSON.parse(localStorage.getItem(SONGS_KEY) || '[]');
      songsEl.innerHTML = '';
      arr.forEach((s,idx)=>{
        const box = document.createElement('div'); box.className='song';
        const title = document.createElement('div'); title.style.flex='1';
        title.innerHTML = `<div style="font-weight:600">${s.title||s.url}</div><div class=\"small\">${new Date(s.date).toLocaleString()}</div>`;
        box.appendChild(title);
        // playback logic
        const controls = document.createElement('div');
        if(s.url.match(/\.mp3$|\.wav$|\.ogg$/i)){
          const audio = document.createElement('audio'); audio.controls=true; audio.src=s.url; audio.style.maxWidth='200px';
          controls.appendChild(audio);
        } else if(s.url.includes('spotify.com') || s.url.includes('open.spotify.com')){
          const iframe = document.createElement('iframe'); iframe.src = s.embed || s.url.replace('open.spotify.com','open.spotify.com/embed'); iframe.width=200; iframe.height=80; iframe.allow='autoplay; encrypted-media'; iframe.style.border='none';
          controls.appendChild(iframe);
        } else if(s.url.includes('youtube') || s.url.includes('youtu.be')){
          // convert to embed
          let id = null; if(s.url.includes('youtube.com')){ const u = new URL(s.url); id = u.searchParams.get('v'); } else { id = s.url.split('/').pop(); }
          if(id){ const iframe = document.createElement('iframe'); iframe.width=200; iframe.height=115; iframe.src='https://www.youtube.com/embed/'+id; iframe.allow='autoplay'; iframe.style.border='none'; controls.appendChild(iframe); }
        } else {
          const link = document.createElement('a'); link.href=s.url; link.target='_blank'; link.textContent='Open'; controls.appendChild(link);
        }
        const del = document.createElement('button'); del.className='btn ghost'; del.textContent='Remove'; del.addEventListener('click', ()=>{ if(confirm('Remove this song?')){ const arr = JSON.parse(localStorage.getItem(SONGS_KEY)||'[]'); arr.splice(idx,1); localStorage.setItem(SONGS_KEY, JSON.stringify(arr)); loadSongs(); } });
        box.appendChild(controls); box.appendChild(del);
        songsEl.appendChild(box);
      })
    }
    document.getElementById('add-song').addEventListener('click', ()=>{
      const url = document.getElementById('song-url').value.trim(); if(!url) return alert('Paste a URL (mp3, spotify or youtube)');
      const arr = JSON.parse(localStorage.getItem(SONGS_KEY) || '[]');
      arr.unshift({url, title: '', date:Date.now()});
      localStorage.setItem(SONGS_KEY, JSON.stringify(arr.slice(0,60)));
      document.getElementById('song-url').value=''; loadSongs();
    })
    loadSongs();

    /* ---------- Small extras ---------- */
    document.getElementById('fav-heart').addEventListener('click', ()=>{ alert('‚ù§Ô∏è Sent! (this is playful ‚Äî connect to notifications if you like)'); })

    // download gallery: create a zip if JSZip available, otherwise open images in new tab as fallback
    document.getElementById('download-all').addEventListener('click', ()=>{
      const arr = JSON.parse(localStorage.getItem(VC_KEY) || '[]'); if(arr.length===0) return alert('No snapshots to download');
      // fallback: open each image in a new tab for manual save
      arr.forEach((a,i)=>{ const w = window.open(a.data); setTimeout(()=>w.document.title='snapshot-'+(i+1),300); });
      alert('Opened images in new tabs ‚Äî right click to save. For a zipped download, host the site and add server-side zipping or include JSZip.');
    })

    /* ---------- Notes for hosting ---------- */
    // This is a single-file static app. To actually save journal entries to the paths '/sagnik/entries' or '/taneesha/entries', create server endpoints that accept POST JSON.
    // Example (express): app.post('/sagnik/entries', (req,res)=>{ saveToDiskOrDB(req.body); res.sendStatus(201); })

  </script>
</body>

<!-- Updated CSS for journal section -->
<style>
  .journal-section {
    margin-bottom: 25px;
  }

  .journal-entry {
    background: linear-gradient(135deg, #fff9f0 0%, #fff5eb 100%);
    border-radius: 15px;
    padding: 25px;
    margin-bottom: 20px;
    border: 1px solid #f1d8e6;
    box-shadow: 0 5px 20px rgba(0,0,0,0.08);
  }

  .journal-input {
    width: 100%;
    min-height: 150px;
    padding: 20px;
    border-radius: 12px;
    border: 1px solid #f1d8e6;
    background: white;
    font-family: 'Poppins', sans-serif;
    font-size: 14px;
    line-height: 1.6;
    resize: vertical;
    margin-bottom: 15px;
    transition: border-color 0.3s ease;
  }

  .journal-input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(255, 111, 181, 0.1);
  }

  .journal-input::placeholder {
    color: var(--muted);
    font-style: italic;
  }

  .journal-controls {
    display: flex;
    gap: 12px;
    align-items: center;
    flex-wrap: wrap;
  }

  .journal-btn {
    padding: 10px 20px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    border: none;
  }

  .journal-btn.primary {
    background: linear-gradient(90deg, var(--accent), var(--accent-2));
    color: white;
  }

  .journal-btn.secondary {
    background: transparent;
    color: var(--accent);
    border: 1px dashed rgba(255, 111, 181, 0.4);
  }

  .journal-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(255, 111, 181, 0.3);
  }

  .journal-feedback {
    font-size: 13px;
    color: var(--muted);
    margin-top: 10px;
    min-height: 18px;
    transition: all 0.3s ease;
  }

  .journal-feedback.success {
    color: #27ae60;
  }

  .journal-feedback.error {
    color: #e74c3c;
  }

  .entries-list {
    margin-top: 25px;
    max-height: 400px;
    overflow-y: auto;
    border-radius: 12px;
    background: white;
    border: 1px solid #f1d8e6;
  }

  .entry-item {
    padding: 20px;
    border-bottom: 1px solid #f1d8e6;
    transition: background-color 0.3s ease;
  }

  .entry-item:hover {
    background: #fffaf6;
  }

  .entry-item:last-child {
    border-bottom: none;
  }

  .entry-date {
    font-size: 12px;
    color: var(--muted);
    margin-bottom: 8px;
    font-weight: 600;
  }

  .entry-content {
    font-size: 14px;
    line-height: 1.6;
    color: #4b2b39;
    white-space: pre-line;
  }

  .empty-entries {
    text-align: center;
    padding: 40px 20px;
    color: var(--muted);
  }

  .empty-entries .icon {
    font-size: 48px;
    margin-bottom: 15px;
    opacity: 0.5;
  }

  /* Loading state */
  .loading {
    opacity: 0.7;
    pointer-events: none;
  }

  .loading::after {
    content: '...';
    animation: dots 1.5s infinite;
  }

  @keyframes dots {
    0%, 20% { content: '.'; }
    40% { content: '..'; }
    60%, 100% { content: '...'; }
  }
</style>

<!-- Updated HTML for journal section -->
<section class="journal-section">
  <h3 style="margin-top:0; margin-bottom:20px; font-size:18px;">Our Shared Journal</h3>
  
  <div class="journal-entry">
    <textarea 
      class="journal-input" 
      id="journal-text" 
      placeholder="Write a memory, a message, or a tiny love note... üíï"
    ></textarea>
    
    <div class="journal-controls">
      <button class="journal-btn primary" id="save-journal">Save Entry</button>
      <button class="journal-btn secondary" id="load-journal">View All Entries</button>
    </div>
    
    <div class="journal-feedback" id="journal-feedback"></div>
  </div>

  <div class="entries-list" id="entries-list" style="display: none;">
    <!-- Entries will be loaded here -->
  </div>
</section>

<!-- Updated JavaScript for journal section -->
<script>
  /* ---------- Journal Section with Server Storage ---------- */
  class JournalManager {
    constructor() {
      this.entries = [];
      this.apiBase = window.location.origin + '/entries';
      this.init();
    }

    init() {
      this.setupEventListeners();
      this.loadLocalEntries(); // Fallback to local storage
    }

    setupEventListeners() {
      document.getElementById('save-journal').addEventListener('click', () => this.saveEntry());
      document.getElementById('load-journal').addEventListener('click', () => this.toggleEntriesList());
      
      // Auto-save on Ctrl+Enter
      document.getElementById('journal-text').addEventListener('keydown', (e) => {
        if (e.ctrlKey && e.key === 'Enter') {
          this.saveEntry();
        }
      });
    }

    async saveEntry() {
      const text = document.getElementById('journal-text').value.trim();
      if (!text) {
        this.showFeedback('Please write something first', 'error');
        return;
      }

      const entry = {
        content: text,
        timestamp: new Date().toISOString(),
        date: this.formatDate(new Date())
      };

      this.setLoadingState(true);
      
      try {
        // Try to save to server first
        const serverSuccess = await this.saveToServer(entry);
        
        if (serverSuccess) {
          this.showFeedback('Entry saved successfully!', 'success');
          document.getElementById('journal-text').value = '';
          this.entries.unshift(entry);
          this.saveToLocalStorage();
        } else {
          // Fallback to local storage
          this.saveToLocalStorage(entry);
          this.showFeedback('Entry saved locally (server unavailable)', 'success');
          document.getElementById('journal-text').value = '';
        }
      } catch (error) {
        console.error('Save error:', error);
        this.saveToLocalStorage(entry);
        this.showFeedback('Entry saved locally', 'success');
        document.getElementById('journal-text').value = '';
      } finally {
        this.setLoadingState(false);
      }
    }

    async saveToServer(entry) {
      try {
        const response = await fetch(`${this.apiBase}/save`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(entry)
        });

        if (response.ok) {
          return true;
        } else {
          throw new Error('Server responded with ' + response.status);
        }
      } catch (error) {
        console.warn('Server save failed, using local storage:', error);
        return false;
      }
    }

    saveToLocalStorage(entry = null) {
      if (entry) {
        this.entries.unshift(entry);
      }
      
      const journalData = {
        entries: this.entries,
        lastUpdated: new Date().toISOString()
      };
      
      localStorage.setItem('shared-journal', JSON.stringify(journalData));
    }

    loadLocalEntries() {
      const saved = localStorage.getItem('shared-journal');
      if (saved) {
        try {
          const data = JSON.parse(saved);
          this.entries = data.entries || [];
        } catch (e) {
          console.error('Error loading local entries:', e);
          this.entries = [];
        }
      }
    }

    async loadServerEntries() {
      try {
        const response = await fetch(`${this.apiBase}/list`);
        if (response.ok) {
          const serverEntries = await response.json();
          // Merge with local entries, remove duplicates
          this.entries = this.mergeEntries(this.entries, serverEntries);
          this.saveToLocalStorage();
          return true;
        }
      } catch (error) {
        console.warn('Could not load from server:', error);
      }
      return false;
    }

    mergeEntries(localEntries, serverEntries) {
      const merged = [...serverEntries];
      const serverTimestamps = new Set(serverEntries.map(e => e.timestamp));
      
      localEntries.forEach(entry => {
        if (!serverTimestamps.has(entry.timestamp)) {
          merged.push(entry);
        }
      });
      
      // Sort by timestamp, newest first
      return merged.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
    }

    toggleEntriesList() {
      const entriesList = document.getElementById('entries-list');
      
      if (entriesList.style.display === 'none') {
        this.showEntries();
        entriesList.style.display = 'block';
      } else {
        entriesList.style.display = 'none';
      }
    }

    async showEntries() {
      await this.loadServerEntries(); // Try to sync with server
      this.renderEntries();
    }

    renderEntries() {
      const entriesList = document.getElementById('entries-list');
      
      if (this.entries.length === 0) {
        entriesList.innerHTML = `
          <div class="empty-entries">
            <div class="icon">üìù</div>
            <p>No entries yet</p>
            <p style="font-size: 12px; margin-top: 5px;">Write your first journal entry!</p>
          </div>
        `;
        return;
      }

      entriesList.innerHTML = this.entries.map(entry => `
        <div class="entry-item">
          <div class="entry-date">
            ${this.formatDisplayDate(entry.timestamp)}
            ${entry.date ? ` ‚Ä¢ ${entry.date}` : ''}
          </div>
          <div class="entry-content">${this.escapeHtml(entry.content)}</div>
        </div>
      `).join('');
    }

    formatDate(date) {
      return date.toLocaleDateString('en-US', {
        year: 'numeric',
        month: 'long',
        day: 'numeric',
        weekday: 'long'
      });
    }

    formatDisplayDate(timestamp) {
      const date = new Date(timestamp);
      const now = new Date();
      const diffTime = Math.abs(now - date);
      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
      
      if (diffDays === 1) {
        return 'Today ‚Ä¢ ' + date.toLocaleTimeString('en-US', { 
          hour: '2-digit', 
          minute: '2-digit' 
        });
      } else if (diffDays === 2) {
        return 'Yesterday ‚Ä¢ ' + date.toLocaleTimeString('en-US', { 
          hour: '2-digit', 
          minute: '2-digit' 
        });
      } else if (diffDays <= 7) {
        return date.toLocaleDateString('en-US', { 
          weekday: 'long',
          hour: '2-digit',
          minute: '2-digit'
        });
      } else {
        return date.toLocaleDateString('en-US', { 
          year: 'numeric',
          month: 'short',
          day: 'numeric',
          hour: '2-digit',
          minute: '2-digit'
        });
      }
    }

    escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    showFeedback(message, type = '') {
      const feedback = document.getElementById('journal-feedback');
      feedback.textContent = message;
      feedback.className = `journal-feedback ${type}`;
      
      setTimeout(() => {
        feedback.textContent = '';
        feedback.className = 'journal-feedback';
      }, 5000);
    }

    setLoadingState(loading) {
      const button = document.getElementById('save-journal');
      const textarea = document.getElementById('journal-text');
      
      if (loading) {
        button.classList.add('loading');
        button.disabled = true;
        textarea.disabled = true;
        this.showFeedback('Saving entry...');
      } else {
        button.classList.remove('loading');
        button.disabled = false;
        textarea.disabled = false;
      }
    }
  }

  // Server API simulation (for development)
  // Remove this in production - your hosting provider should handle the API
  class JournalServerSimulator {
    constructor() {
      this.entries = JSON.parse(localStorage.getItem('server-journal') || '[]');
    }

    async saveEntry(entry) {
      // Simulate server delay
      await new Promise(resolve => setTimeout(resolve, 500));
      
      this.entries.unshift(entry);
      localStorage.setItem('server-journal', JSON.stringify(this.entries));
      return true;
    }

    async listEntries() {
      // Simulate server delay
      await new Promise(resolve => setTimeout(resolve, 300));
      return this.entries;
    }
  }

  // Initialize journal when page loads
  document.addEventListener('DOMContentLoaded', () => {
    // For development/demo purposes - remove in production
    window.journalServer = new JournalServerSimulator();
    
    // Initialize the main journal manager
    window.journalManager = new JournalManager();
  });
</script>







</html>